{"version":3,"sources":["../node_modules/zxdom/src/index.js","../node_modules/classcat/src/index.js","const.js","keyboard/index.js","synth/instrument.js","option-buttons.js","synth/synth.js","synth/index.js","sequencer/index.js","index.js","../../../../../usr/local/lib/node_modules/parcel-bundler/src/builtins/bundle-url.js","../../../../../usr/local/lib/node_modules/parcel-bundler/src/builtins/css-loader.js"],"names":["h","type","attributes","children","concat","filter","c","mount","vnode","container","el","make","innerHTML","appendChild","define","func","data","update","view","instances","forEach","inst","patchInstance","svg","document","createTextNode","makeInstance","makeElement","patch","oldnode","newnode","patchElement","replace","remove","oldvnode","willRemove","parentNode","removeChild","newvnode","newel","replaceChild","willRemoveInstance","willRemoveElement","vnodeForView","push","oldel","getKey","node","attr","key","getInstanceIndex","splice","index","instance","seekIndex","Object","assign","createElementNS","createElement","updateAttributes","chnode","oncreate","oldattr","oldch","newattr","newch","patchChildren","onupdate","i","childNodes","onremove","parent","slice","n","length","o","seekNode","insertBefore","didRemove","list","start","sought","seekId","item","keys","name","setAttribute","oldval","val","substr","removeAttribute","fn","reduce","found","cat","classes","prefix","value","className","Array","isArray","len","hasOwnProperty","SEQUENCER_LENGTH","SEQUENCER_INTERVAL","NOTE_NAMES","KEYBOARD_KEYS","KEYBOARD_BLACK_KEYS","SYNTH_DEFAULTS","octave","oscillatorType","ampLevel","sustainLevel","attackTime","decayTime","releaseTime","filterCutoff","filterQ","OSCILLATOR_TYPES","TUNING_FREQ","TUNING_NOTE","onattack","onrelease","pressed","attack","note","indexOf","char","release","addEventListener","ev","preventDefault","css","keyboard","map","clav","black","toUpperCase","Keyboard","noteToHz","Math","exp","log","ctx","window","AudioContext","webkitAudioContext","Instrument","oscillator","createOscillator","createBiquadFilter","envelope","createGain","amplifier","connect","destination","set","gain","props","frequency","Q","freq","t","currentTime","cancelScheduledValues","linearRampToValueAtTime","options","active","opt","Control","label","ControlSlider","min","max","step","currentTarget","ControlOptions","ControlPanel","settings","controlProps","x","synthPanel","col1","col2","Synth","instrument","onselect","bank","A","B","C","D","E","F","G","H","current","select","synth","Selector","split","notes","Sequencer","sequencer","vals","row","time","col","soundbank","console","appLayout","appLayoutLeft","mainPanel","appLayoutRight","body","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","exports","bundle","require","updateLink","link","newLink","cloneNode","onload","href","Date","now","nextSibling","cssTimeout","reloadCSS","setTimeout","links","querySelectorAll","module"],"mappings":"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","file":"src.7deb02e7.map","sourceRoot":"../src","sourcesContent":["/*\nTODO refactor tests to be more descriptive of the api and less \"incrementally built up\"\n\nTODO: Optimize: textnodes are always inserted, then the old ones removed. If they're the same string we could leave them alone\nTODO: Optimize: If keyed nodes move down, we will instead move *up* every subsequent nodes one step. COuld be optimized\nby just building a list of moves, and notice that a series of up-moves of one, could be replaced by a single\ndown move (maybe?)\n*/\n\nfunction h (type, attributes, ...children) {\n    attributes = attributes || {}\n    children = [].concat(...[].concat(...children)).filter(c => (c !== false && c != null))\n    return (typeof type === 'function') ? type(attributes, children) : {type, attributes, children}\n}\n\nfunction mount (vnode, container) {\n    const el = make(vnode)\n    container.innerHTML = ''\n    container.appendChild(el)\n    return el\n}\n\nfunction define (func, data) {\n    return {func, data}\n}\n\n\nfunction update (view, data) {\n    view.data = data\n    view.instances = view.instances || [] //common pattern with makeInstance --> factor out\n    view.instances.forEach(inst => patchInstance(inst.el, view, inst.attributes, inst.children))\n}\n\n//-------------\n\nfunction make (vnode, svg) {\n    if (vnode.func) return make(h(vnode))\n    if (!vnode.type) return document.createTextNode(vnode)\n    return (vnode.type.func ? makeInstance : makeElement)(vnode, svg)\n}\n\nfunction patch (el, oldnode, newnode) {\n    if (oldnode.type && oldnode.type === newnode.type) {\n        if (oldnode.type.func) {\n            el = patchInstance(el, newnode.type, newnode.attributes, newnode.children)\n        } else {\n            el = patchElement(el, oldnode.attributes, oldnode.children, newnode.attributes, newnode.children)\n        }\n    } else {\n        el = replace(el, oldnode, newnode)\n    }\n    return el\n}\n\nfunction remove(el, oldvnode) {\n    willRemove(el, oldvnode)\n    el.parentNode && el.parentNode.removeChild(el)\n    return true\n}\n\nfunction replace (el, oldvnode, newvnode) {\n    const newel = make(newvnode)\n    willRemove(el, oldvnode)\n    el.parentNode && el.parentNode.replaceChild(newel, el)\n    return newel\n}\n\nfunction willRemove(el, oldvnode) {\n    if (!oldvnode.type) return false\n    if (oldvnode.type.func) return willRemoveInstance(el, oldvnode)\n    return willRemoveElement(el, oldvnode)\n}\n\n//-------------\n\nfunction makeInstance ({type, attributes, children}) {\n    const vnode = vnodeForView(type, attributes, children)\n    const el = make(vnode)\n    type.instances = type.instances || []\n    type.instances.push({el, vnode, attributes, children})\n    return el\n}\n\nfunction patchInstance (oldel, view, attributes, children) {\n    function getKey (node) {\n        const attr = node.attributes\n        return (attr && attr.key) ? attr.key : null \n    }\n    const vnode = vnodeForView(view, attributes, children)\n    const inst = getInstanceIndex(view, oldel)\n    const oldvnode = view.instances[inst].vnode\n    const el = (getKey(oldvnode) === getKey(vnode) ? patch : replace)(oldel, oldvnode, vnode)\n    view.instances.splice(inst, 1, {el, vnode, attributes, children})\n    return el\n}\n\nfunction willRemoveInstance (el, {type}) {\n    const index = getInstanceIndex(type, el)\n    const instance = type.instances[index]\n    type.instances.splice(index, 1)\n    return willRemove(el, instance.vnode)\n}\n\nfunction getInstanceIndex(type, el) {\n    return seekIndex(type.instances, inst => (inst.el === el))\n}\n\nfunction vnodeForView(type, attributes, children) {\n    return type.func(Object.assign({}, attributes, type.data), children)\n}\n\n//-------------\n\nfunction makeElement ({type, attributes, children}, svg=false) {\n    svg = svg || (type === 'svg')\n    const el = svg ? document.createElementNS('http://www.w3.org/2000/svg', type) : document.createElement(type)\n    updateAttributes(el, {}, attributes)\n    children.forEach(chnode => el.appendChild(make(chnode, svg)))\n    attributes.oncreate && attributes.oncreate(el)\n    return el\n}\n\nfunction patchElement(el, oldattr, oldch, newattr, newch) {\n    updateAttributes(el, oldattr, newattr)\n    patchChildren(el, oldch, newch)\n    newattr.onupdate && newattr.onupdate(el)\n    return el\n}\n\nfunction willRemoveElement (el, {attributes, children}) {\n    children.forEach((c, i) => willRemove(el.childNodes[i], c))\n    return attributes.onremove && attributes.onremove(el, el.parentNode)\n}\n\n//-----------------\n\nfunction patchChildren(parent, oldch, newch) {\n    oldch = oldch.slice() //copy, since we'll be mutating it further down.\n    let n = 0\n    while (n < oldch.length && n < newch.length) {\n        let o = seekNode(oldch, newch[n], n)\n        if (o < 0) {\n            parent.insertBefore(make(newch[n]), parent.childNodes[n])\n            oldch.splice(n, 0, '')\n        } else {\n            if (o != n) {\n                parent.insertBefore(parent.childNodes[o], parent.childNodes[n])\n                oldch.splice(n, 0, oldch.splice(o, 1)[0])\n            }\n            patch(parent.childNodes[n], oldch[n], newch[n])\n        }\n        n++\n    }\n    while (n < oldch.length) {\n        const didRemove = remove(parent.childNodes[n], oldch[n])\n        if (!didRemove) n++\n        else oldch.splice(n, 1)\n    }\n    while (n < newch.length)  parent.appendChild(make(newch[n++]))\n}\n\n\nfunction seekNode(list, node, start) {\n    const sought = seekId(node)\n    return seekIndex(list, item => (seekId(item) === sought), start)\n}\n\nfunction seekId(node) {\n    return node.type ? (node.attributes.key || node.type) : node\n}\n\nfunction updateAttributes (el, oldattr, newattr) {\n    Object.keys(oldattr).forEach(name => {\n        if (newattr[name] == null) setAttribute(el, name)\n    })\n    Object.keys(newattr).forEach(name => {\n        setAttribute(el, name, oldattr[name], newattr[name])\n    })\n}\n\nfunction setAttribute(el, name, oldval, val) {\n    if (name === 'key' || name === 'value' || name === 'checked' || name.substr(0,2) === 'on') {\n        el[name] = val\n    } else if (val == null || val === false) {\n        el.removeAttribute(name)\n    } else if (oldval !== val) {\n        el.setAttribute(name, val)\n    }\n}\n\n//----------------\n\nfunction seekIndex(list, fn, start = 0) {\n    return list.reduce((found, item, index) => (index < start || found > -1 || !fn(item)) ? found : index, -1)\n}\n\n//----------------\n\nexport {h, patch, make, mount, define, update}","export default function cat(classes, prefix) {\n  var value\n  var className = \"\"\n  var type = typeof classes\n\n  if ((classes && type === \"string\") || type === \"number\") {\n    return classes\n  }\n\n  prefix = prefix || \" \"\n\n  if (Array.isArray(classes) && classes.length) {\n    for (var i = 0, len = classes.length; i < len; i++) {\n      if ((value = cat(classes[i], prefix))) {\n        className += (className && prefix) + value\n      }\n    }\n  } else {\n    for (var i in classes) {\n      if (classes.hasOwnProperty(i) && (value = classes[i])) {\n        className +=\n          (className && prefix) +\n          i +\n          (typeof value === \"object\" ? cat(value, prefix + i) : \"\")\n      }\n    }\n  }\n\n  return className\n}\n","\nexport const SEQUENCER_LENGTH = 32\nexport const SEQUENCER_INTERVAL = 100\nexport const NOTE_NAMES = [\n    'C', 'C#', 'D', 'Eb',\n    'E', 'F', 'F#', 'G',\n    'Ab', 'A', 'Bb', 'B',\n    'C', 'C#', 'D', 'Eb',\n    'E', 'F', 'F#', 'G',\n    'Ab', 'A', 'Bb', 'B',\n    'C'\n]\nexport const KEYBOARD_KEYS = [\n    'z','s','x','d','c','v',\n    'g','b','h','n','j','m',\n    'q','2','w','3','e','r',\n    '5','t','6','y','7','u',\n    'i'\n]\n\nexport const KEYBOARD_BLACK_KEYS = [\n    's', 'd', 'g', 'h', 'j',\n    '2', '3', '5', '6', '7'\n]\n\nexport const SYNTH_DEFAULTS = {\n    octave: 4,\n    oscillatorType: 'triangle',\n    ampLevel: 0.3,\n    sustainLevel: 0.6,\n    attackTime: 0.02,\n    decayTime: 0.04,\n    releaseTime: 0.4,\n    filterCutoff: 7600,\n    filterQ: 10,\n}\n\n\nexport const OSCILLATOR_TYPES = ['sawtooth', 'square', 'triangle', 'sine']\n\nexport const TUNING_FREQ = 440;\nexport const TUNING_NOTE = 69;","import {h, define, update} from 'zxdom'\nimport cc from 'classcat'\nimport css from './style.css'\nimport {KEYBOARD_KEYS, KEYBOARD_BLACK_KEYS} from '../const'\n\n\nexport default function ({onattack, onrelease}) {\n    \n    var pressed = null\n\n    const attack = char => {\n        const note = KEYBOARD_KEYS.indexOf(char)\n        if (note === -1) return\n        if (char === pressed) return\n        pressed = char\n        update(view)\n        onattack(note)\n    }\n\n    const release = char => {\n        const note = KEYBOARD_KEYS.indexOf(char)\n        if (note === -1) return\n        if (char !== pressed) return\n        pressed = null\n        update(view)\n        onrelease(note)\n    }\n\n    const view = define(_ => (\n        <div oncreate={el => {\n            addEventListener('keydown', ev => attack(ev.key) && ev.preventDefault(true))\n            addEventListener('keyup', ev => release(ev.key) && ev.preventDefault(true))\n        }}class={css.keyboard} key=\"keyboard\">\n            {KEYBOARD_KEYS.map(char => (\n            <div\n                class={cc({\n                    [css.clav]: true,\n                    [css.black]: KEYBOARD_BLACK_KEYS.indexOf(char) >= 0,\n                    [css.pressed]: char === pressed,\n                })}\n                onmousedown={ _ => attack(char) }\n                onmouseup={ _ => release(char) }\n            >\n                <span class={css.char}>{char.toUpperCase()}</span>\n            </div>\n            ))}\n        </div>\n    ))\n\n    return {Keyboard: view}\n}\n\n","import {TUNING_NOTE, TUNING_FREQ, SYNTH_DEFAULTS} from '../const'\n\nfunction noteToHz (note, octave) {\n    return Math.exp ((octave * 12 + note  - TUNING_NOTE) * Math.log(2) / 12) * TUNING_FREQ;\n}\n\nconst ctx = new (window.AudioContext || window.webkitAudioContext)()\n\nexport default class Instrument {\n    \n    constructor () {\n        this.oscillator = ctx.createOscillator()\n        this.filter = ctx.createBiquadFilter()\n        this.envelope = ctx.createGain()\n        this.amplifier = ctx.createGain()\n\n        this.oscillator.connect(this.filter)\n        this.filter.connect(this.envelope)\n        this.envelope.connect(this.amplifier)\n        this.amplifier.connect(ctx.destination)\n        this.set(SYNTH_DEFAULTS)\n        this.envelope.gain.value = 0;\n        this.oscillator.start()\n    }\n\n    set (props) {\n        if (props.oscillatorType) this.oscillator.type = props.oscillatorType\n        if (props.filterCutoff)   this.filter.frequency.value = props.filterCutoff\n        if (props.filterQ)        this.filter.Q.value = props.filterQ\n        if (props.ampLevel)       this.amplifier.gain.value = props.ampLevel\n        if (props.attackTime)     this.attackTime = props.attackTime\n        if (props.decayTime)      this.decayTime = props.decayTime\n        if (props.sustainLevel)   this.sustainLevel = props.sustainLevel\n        if (props.octave)         this.octave = props.octave\n        if (props.releaseTime)    this.releaseTime = props.releaseTime\n    }\n\n    attack (note) {\n        const freq = noteToHz(note, this.octave)\n        var t = ctx.currentTime\n        this.oscillator.frequency.cancelScheduledValues(t)\n        this.envelope.gain.cancelScheduledValues(t)\n        t += 0.01\n        this.oscillator.frequency.linearRampToValueAtTime(freq, t)\n        this.envelope.gain.linearRampToValueAtTime(0, t)\n        t += this.attackTime\n        this.envelope.gain.linearRampToValueAtTime(1, t)\n        t += this.decayTime\n        this.envelope.gain.linearRampToValueAtTime(this.sustainLevel, t)    \n    }\n\n    release () { \n        var t = ctx.currentTime + 0.01\n        this.envelope.gain.cancelScheduledValues(t)\n        t += this.releaseTime\n        this.envelope.gain.linearRampToValueAtTime(0, t)\n    }\n}\n","import {h} from 'zxdom'\nimport cc from 'classcat'\n\nexport default props => props.options.map(opt => (\n    <button\n        class={cc({active: opt.value === props.value})}\n        onclick={ev => props.set(opt.value)}\n    >\n        {opt.name}\n    </button>\n))\n","import Instrument from './instrument'\nimport {h, define, update} from 'zxdom'\nimport cc from 'classcat'\nimport {SYNTH_DEFAULTS, OSCILLATOR_TYPES} from '../const'\nimport css from './style.css'\nimport OptionButtonSet from '../option-buttons'\n\nconst Control = (props, children) => (\n    <p>\n        <span class={css.label}>{props.label}:</span>\n        {children}\n    </p>\n)\n\nconst ControlSlider = props => (\n    <Control label={props.label}>\n        <input\n            type=\"range\"\n            min={props.min || 0}\n            max={props.max}\n            step={props.step || 'any'}\n            value={props.value}\n            oninput={ev => props.set(+ev.currentTarget.value)}\n        />\n    </Control>\n)\n\nconst ControlOptions = props => (\n    <Control label={props.label}>\n        <OptionButtonSet\n            options={props.options.map(o => ({name: o, value: o}))}\n            value={props.value}\n            set={props.set}\n        />\n    </Control>\n)\n\nconst ControlPanel = ({settings, set}) => {\n    const controlProps = name => ({\n        value: settings[name],\n        set: x => set({[name]: x})\n    })\n\n    return (\n        <div class={css.synthPanel}>\n            <div class={css.col1}>\n                <ControlSlider  label=\"Octave\" {...controlProps('octave')} min={1} max={6} step={1} />\n                <ControlOptions label=\"Oscillator\" {...controlProps('oscillatorType')} options={OSCILLATOR_TYPES} />\n                <ControlSlider  label=\"Cutoff\" {...controlProps('filterCutoff')}   min={60} max={7600} />\n                <ControlSlider  label=\"Resonance\"  {...controlProps('filterQ')}        max={20} />\n            </div>\n            <div class={css.col2}>\n                <ControlSlider label=\"Attack time\"   {...controlProps('attackTime')}   max={0.2} />\n                <ControlSlider label=\"Decay time\"    {...controlProps('decayTime')}    max={0.2} />\n                <ControlSlider label=\"Sustain level\" {...controlProps('sustainLevel')} max={1.0} />\n                <ControlSlider label=\"Release time\"  {...controlProps('releaseTime')}  max={1.0} />\n                <ControlSlider label=\"Gain\"          {...controlProps('ampLevel')}     max={1.0} />\n            </div>\n        </div>\n    )\n}\n\nexport default class Synth{\n    constructor () {\n        this.instrument = new Instrument()\n        this.settings = Object.assign({}, SYNTH_DEFAULTS)\n        this.view = define(_ => ControlPanel({\n            settings: this.settings,\n            set: x => this.set(x)\n        }))\n    }\n    get ControlPanel () { return this.view }\n    set (props) {\n        this.instrument.set(props)\n        Object.assign(this.settings, props)\n        update(this.view)\n    }\n    attack (note) { this.instrument.attack(note)}\n    release (note) { this.instrument.release(note)}\n}\n","import Synth from './synth'\nimport {h, define, update} from 'zxdom'\nimport OptionButtonSet from '../option-buttons'\n\nexport default function (onselect) {\n\n    const bank = {\n        A: new Synth(),\n        B: new Synth(),\n        C: new Synth(),\n        D: new Synth(),\n        E: new Synth(),\n        F: new Synth(),\n        G: new Synth(),\n        H: new Synth(),\n    }\n\n    var current = 'A'\n\n    function select (synth) {\n        current = synth\n        update(Selector)\n        update(ControlPanel)\n        onselect(synth)\n    }\n\n    const ControlPanel = define(_ => h(bank[current].ControlPanel))\n\n    const Selector = define(_ => (\n        <div class=\"voice-selector\">\n            <OptionButtonSet\n                options={'ABCDEFGH'.split('').map(n => ({name: `Voice ${n}`, value:n}))}\n                set={select}\n                value={current}\n            />\n        </div>\n    ))\n\n    function attack (note) {\n        bank[current].attack(note)\n    }\n    function release (note) {\n        bank[current].release(note)\n    }\n    \n    return {attack, release, ControlPanel, Selector}\n}\n","import {h, define, update} from 'zxdom'\nimport css from './style.css'\nimport {SEQUENCER_LENGTH, NOTE_NAMES} from '../const'\n\n\nexport default function () {\n    var notes = [...Array(SEQUENCER_LENGTH).keys()].map(_ => [...Array(8).keys()].map(_ => null))\n\n    const Sequencer = define(_ => (\n        <table class={css.sequencer}>\n            {notes.map((vals, row) => (\n                <tr>\n                    <td class={css.time}>{row}</td>\n                    {vals.map((note, col) => (\n                        <td>{(note === null) ? '' : NOTE_NAMES[note]}</td>\n                    ))}\n                </tr>\n            ))}\n        </table>\n    ))\n\n    return {Sequencer}\n}\n","import {h, mount} from 'zxdom'\nimport css from './style.css'\nimport Keyboard from './keyboard'\nimport Soundbank from './synth'\nimport Sequencer from './sequencer'\n\nconst sequencer = Sequencer()\n\nconst soundbank = Soundbank({\n    onselect: x => console.log('SELECTED', x)\n})\n\nconst keyboard = Keyboard({\n    onattack: note => soundbank.attack(note),\n    onrelease: note => soundbank.release(note)\n})\n\n\n\nmount((\n    <div class={css.appLayout}>\n        <div class={css.appLayoutLeft}>\n            <div class={css.mainPanel}>\n                <soundbank.Selector />\n                <soundbank.ControlPanel />\n            </div>\n            <keyboard.Keyboard />\n        </div>\n        <div class={css.appLayoutRight}>\n            <sequencer.Sequencer />\n        </div>\n    </div>\n\n), document.body)","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}