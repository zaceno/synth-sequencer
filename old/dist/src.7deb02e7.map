{"version":3,"sources":["../node_modules/hyperapp/src/index.js","lib/combine-modules.js","../node_modules/classcat/src/index.js","const.js","keyboard.js","lib/decorator.js","selection.js","button.js","playback.js","sequencer.js","voices.js","option-button-set.js","synth.js","soundbank.js","main.js","index.js","../../../../../usr/local/lib/node_modules/parcel-bundler/src/builtins/bundle-url.js","../../../../../usr/local/lib/node_modules/parcel-bundler/src/builtins/css-loader.js"],"names":["h","app","name","attributes","rest","children","length","arguments","push","node","pop","nodeName","key","state","actions","view","container","map","rootElement","oldNode","recycleElement","lifecycle","skipRender","isRecycling","globalState","clone","wiredActions","wireStateToActions","scheduleRender","element","toLowerCase","call","childNodes","nodeType","nodeValue","resolveNode","render","patch","setTimeout","target","source","out","i","setPartialState","path","value","slice","getPartialState","action","data","result","then","concat","getKey","eventListener","event","currentTarget","events","type","updateAttribute","oldValue","isSvg","style","setProperty","addEventListener","removeEventListener","setAttribute","removeAttribute","createElement","document","createTextNode","createElementNS","oncreate","appendChild","updateElement","oldAttributes","cb","onupdate","removeChildren","ondestroy","removeElement","parent","done","removeChild","onremove","newElement","insertBefore","oldKeyed","newKeyed","oldElements","oldChildren","oldKey","k","newKey","keyedNode","combineModules","tree","modules","subviews","cc","classes","prefix","className","Array","isArray","len","hasOwnProperty","SEQUENCER_LENGTH","SEQUENCER_INTERVAL","NOTE_NAMES","KEYBOARD_KEYS","KEYBOARD_BLACK_KEYS","SYNTH_DEFAULTS","octave","oscillatorType","ampLevel","sustainLevel","attackTime","decayTime","releaseTime","filterCutoff","filterQ","OSCILLATOR_TYPES","TUNING_FREQ","TUNING_NOTE","isBlack","indexOf","char","Keyboard","pressed","attack","release","css","keyboard","clav","black","toUpperCase","init","onpress","ev","preventDefault","note","stackHandlers","attr","handler","orig","fn","decorations","getDeco","child","class","substr","isSelected","row","col","start","r","column","end","applySelection","notes","rowvals","val","module","anchor","selecting","haveSelection","_set","x","onselectcolumn","reset","select","Decorator","disabled","onmousedown","onmouseup","onmouseover","selected","props","active","cmd","do","playing","interval","onplayrow","onstop","onstart","setRow","next","play","setInterval","stop","clearInterval","PlayButton","StopButton","noteName","selection","playback","keys","onselectvoice","onplay","window","controlPress","playRow","stopRecording","setNoteOnSelection","voice","recording","recordNote","recordingNote","setRecordedNote","forEach","startRecording","arr","oldNote","views","Controls","setNote","Sequencer","scrollContainer","sequencer","vals","el","scrollIntoView","time","noteToHz","Math","exp","log","ctx","AudioContext","webkitAudioContext","Instrument","oscillator","createOscillator","filter","createBiquadFilter","envelope","createGain","amplifier","connect","destination","set","gain","frequency","Q","freq","t","currentTime","cancelScheduledValues","linearRampToValueAtTime","instruments","options","opt","Control","label","ControlSlider","min","max","step","ControlOptions","o","current","voices","controlProps","ControlPanel","synthPanel","col1","col2","A","B","C","D","E","F","G","H","onselect","_","stopAll","split","v","Selector","voiceSelector","n","soundbank","keyPress","sequencerPlay","left","mainPanel","main","body","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","replace","exports","bundle","require","updateLink","link","newLink","cloneNode","onload","remove","href","Date","now","parentNode","nextSibling","cssTimeout","reloadCSS","links","querySelectorAll"],"mappings":"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","file":"src.7deb02e7.map","sourceRoot":"../src","sourcesContent":["export function h(name, attributes) {\n  var rest = []\n  var children = []\n  var length = arguments.length\n\n  while (length-- > 2) rest.push(arguments[length])\n\n  while (rest.length) {\n    var node = rest.pop()\n    if (node && node.pop) {\n      for (length = node.length; length--; ) {\n        rest.push(node[length])\n      }\n    } else if (node != null && node !== true && node !== false) {\n      children.push(node)\n    }\n  }\n\n  return typeof name === \"function\"\n    ? name(attributes || {}, children)\n    : {\n        nodeName: name,\n        attributes: attributes || {},\n        children: children,\n        key: attributes && attributes.key\n      }\n}\n\nexport function app(state, actions, view, container) {\n  var map = [].map\n  var rootElement = (container && container.children[0]) || null\n  var oldNode = rootElement && recycleElement(rootElement)\n  var lifecycle = []\n  var skipRender\n  var isRecycling = true\n  var globalState = clone(state)\n  var wiredActions = wireStateToActions([], globalState, clone(actions))\n\n  scheduleRender()\n\n  return wiredActions\n\n  function recycleElement(element) {\n    return {\n      nodeName: element.nodeName.toLowerCase(),\n      attributes: {},\n      children: map.call(element.childNodes, function(element) {\n        return element.nodeType === 3 // Node.TEXT_NODE\n          ? element.nodeValue\n          : recycleElement(element)\n      })\n    }\n  }\n\n  function resolveNode(node) {\n    return typeof node === \"function\"\n      ? resolveNode(node(globalState, wiredActions))\n      : node != null\n        ? node\n        : \"\"\n  }\n\n  function render() {\n    skipRender = !skipRender\n\n    var node = resolveNode(view)\n\n    if (container && !skipRender) {\n      rootElement = patch(container, rootElement, oldNode, (oldNode = node))\n    }\n\n    isRecycling = false\n\n    while (lifecycle.length) lifecycle.pop()()\n  }\n\n  function scheduleRender() {\n    if (!skipRender) {\n      skipRender = true\n      setTimeout(render)\n    }\n  }\n\n  function clone(target, source) {\n    var out = {}\n\n    for (var i in target) out[i] = target[i]\n    for (var i in source) out[i] = source[i]\n\n    return out\n  }\n\n  function setPartialState(path, value, source) {\n    var target = {}\n    if (path.length) {\n      target[path[0]] =\n        path.length > 1\n          ? setPartialState(path.slice(1), value, source[path[0]])\n          : value\n      return clone(source, target)\n    }\n    return value\n  }\n\n  function getPartialState(path, source) {\n    var i = 0\n    while (i < path.length) {\n      source = source[path[i++]]\n    }\n    return source\n  }\n\n  function wireStateToActions(path, state, actions) {\n    for (var key in actions) {\n      typeof actions[key] === \"function\"\n        ? (function(key, action) {\n            actions[key] = function(data) {\n              var result = action(data)\n\n              if (typeof result === \"function\") {\n                result = result(getPartialState(path, globalState), actions)\n              }\n\n              if (\n                result &&\n                result !== (state = getPartialState(path, globalState)) &&\n                !result.then // !isPromise\n              ) {\n                scheduleRender(\n                  (globalState = setPartialState(\n                    path,\n                    clone(state, result),\n                    globalState\n                  ))\n                )\n              }\n\n              return result\n            }\n          })(key, actions[key])\n        : wireStateToActions(\n            path.concat(key),\n            (state[key] = clone(state[key])),\n            (actions[key] = clone(actions[key]))\n          )\n    }\n\n    return actions\n  }\n\n  function getKey(node) {\n    return node ? node.key : null\n  }\n\n  function eventListener(event) {\n    return event.currentTarget.events[event.type](event)\n  }\n\n  function updateAttribute(element, name, value, oldValue, isSvg) {\n    if (name === \"key\") {\n    } else if (name === \"style\") {\n      for (var i in clone(oldValue, value)) {\n        var style = value == null || value[i] == null ? \"\" : value[i]\n        if (i[0] === \"-\") {\n          element[name].setProperty(i, style)\n        } else {\n          element[name][i] = style\n        }\n      }\n    } else {\n      if (name[0] === \"o\" && name[1] === \"n\") {\n        name = name.slice(2)\n\n        if (element.events) {\n          if (!oldValue) oldValue = element.events[name]\n        } else {\n          element.events = {}\n        }\n\n        element.events[name] = value\n\n        if (value) {\n          if (!oldValue) {\n            element.addEventListener(name, eventListener)\n          }\n        } else {\n          element.removeEventListener(name, eventListener)\n        }\n      } else if (\n        name in element &&\n        name !== \"list\" &&\n        name !== \"type\" &&\n        name !== \"draggable\" &&\n        name !== \"spellcheck\" &&\n        name !== \"translate\" &&\n        !isSvg\n      ) {\n        element[name] = value == null ? \"\" : value\n      } else if (value != null && value !== false) {\n        element.setAttribute(name, value)\n      }\n\n      if (value == null || value === false) {\n        element.removeAttribute(name)\n      }\n    }\n  }\n\n  function createElement(node, isSvg) {\n    var element =\n      typeof node === \"string\" || typeof node === \"number\"\n        ? document.createTextNode(node)\n        : (isSvg = isSvg || node.nodeName === \"svg\")\n          ? document.createElementNS(\n              \"http://www.w3.org/2000/svg\",\n              node.nodeName\n            )\n          : document.createElement(node.nodeName)\n\n    var attributes = node.attributes\n    if (attributes) {\n      if (attributes.oncreate) {\n        lifecycle.push(function() {\n          attributes.oncreate(element)\n        })\n      }\n\n      for (var i = 0; i < node.children.length; i++) {\n        element.appendChild(\n          createElement(\n            (node.children[i] = resolveNode(node.children[i])),\n            isSvg\n          )\n        )\n      }\n\n      for (var name in attributes) {\n        updateAttribute(element, name, attributes[name], null, isSvg)\n      }\n    }\n\n    return element\n  }\n\n  function updateElement(element, oldAttributes, attributes, isSvg) {\n    for (var name in clone(oldAttributes, attributes)) {\n      if (\n        attributes[name] !==\n        (name === \"value\" || name === \"checked\"\n          ? element[name]\n          : oldAttributes[name])\n      ) {\n        updateAttribute(\n          element,\n          name,\n          attributes[name],\n          oldAttributes[name],\n          isSvg\n        )\n      }\n    }\n\n    var cb = isRecycling ? attributes.oncreate : attributes.onupdate\n    if (cb) {\n      lifecycle.push(function() {\n        cb(element, oldAttributes)\n      })\n    }\n  }\n\n  function removeChildren(element, node) {\n    var attributes = node.attributes\n    if (attributes) {\n      for (var i = 0; i < node.children.length; i++) {\n        removeChildren(element.childNodes[i], node.children[i])\n      }\n\n      if (attributes.ondestroy) {\n        attributes.ondestroy(element)\n      }\n    }\n    return element\n  }\n\n  function removeElement(parent, element, node) {\n    function done() {\n      parent.removeChild(removeChildren(element, node))\n    }\n\n    var cb = node.attributes && node.attributes.onremove\n    if (cb) {\n      cb(element, done)\n    } else {\n      done()\n    }\n  }\n\n  function patch(parent, element, oldNode, node, isSvg) {\n    if (node === oldNode) {\n    } else if (oldNode == null || oldNode.nodeName !== node.nodeName) {\n      var newElement = createElement(node, isSvg)\n      parent.insertBefore(newElement, element)\n\n      if (oldNode != null) {\n        removeElement(parent, element, oldNode)\n      }\n\n      element = newElement\n    } else if (oldNode.nodeName == null) {\n      element.nodeValue = node\n    } else {\n      updateElement(\n        element,\n        oldNode.attributes,\n        node.attributes,\n        (isSvg = isSvg || node.nodeName === \"svg\")\n      )\n\n      var oldKeyed = {}\n      var newKeyed = {}\n      var oldElements = []\n      var oldChildren = oldNode.children\n      var children = node.children\n\n      for (var i = 0; i < oldChildren.length; i++) {\n        oldElements[i] = element.childNodes[i]\n\n        var oldKey = getKey(oldChildren[i])\n        if (oldKey != null) {\n          oldKeyed[oldKey] = [oldElements[i], oldChildren[i]]\n        }\n      }\n\n      var i = 0\n      var k = 0\n\n      while (k < children.length) {\n        var oldKey = getKey(oldChildren[i])\n        var newKey = getKey((children[k] = resolveNode(children[k])))\n\n        if (newKeyed[oldKey]) {\n          i++\n          continue\n        }\n\n        if (newKey != null && newKey === getKey(oldChildren[i + 1])) {\n          if (oldKey == null) {\n            removeElement(element, oldElements[i], oldChildren[i])\n          }\n          i++\n          continue\n        }\n\n        if (newKey == null || isRecycling) {\n          if (oldKey == null) {\n            patch(element, oldElements[i], oldChildren[i], children[k], isSvg)\n            k++\n          }\n          i++\n        } else {\n          var keyedNode = oldKeyed[newKey] || []\n\n          if (oldKey === newKey) {\n            patch(element, keyedNode[0], keyedNode[1], children[k], isSvg)\n            i++\n          } else if (keyedNode[0]) {\n            patch(\n              element,\n              element.insertBefore(keyedNode[0], oldElements[i]),\n              keyedNode[1],\n              children[k],\n              isSvg\n            )\n          } else {\n            patch(element, oldElements[i], null, children[k], isSvg)\n          }\n\n          newKeyed[newKey] = children[k]\n          k++\n        }\n      }\n\n      while (i < oldChildren.length) {\n        if (getKey(oldChildren[i]) == null) {\n          removeElement(element, oldElements[i], oldChildren[i])\n        }\n        i++\n      }\n\n      for (var i in oldKeyed) {\n        if (!newKeyed[i]) {\n          removeElement(element, oldKeyed[i][0], oldKeyed[i][1])\n        }\n      }\n    }\n    return element\n  }\n}\n","export default function combineModules (tree) {\n    const modules = {}\n\n    for (let name in (tree.modules || {})) {\n        modules[name] = combineModules(tree.modules[name])\n    }\n\n    const state = tree.state || {}\n    const actions = tree.actions || {}\n\n    for (let name in modules) {\n        state[name] = modules[name].state || {}\n        actions[name] = modules[name].actions || {}\n    }\n\n    const view = (state, actions) => {\n        const subviews = {}\n        for (let name in modules) {\n            if (!modules[name].view) continue\n            subviews[name] = modules[name].view(\n                state[name],\n                actions[name]\n            )\n        }\n        return tree.view && tree.view(state, actions, subviews)\n    }\n\n    return {state, actions, view}\n}","export default function cc(classes, prefix) {\n  var value\n  var className = \"\"\n  var type = typeof classes\n\n  if ((classes && type === \"string\") || type === \"number\") {\n    return classes\n  }\n\n  prefix = prefix || \" \"\n\n  if (Array.isArray(classes) && classes.length) {\n    for (var i = 0, len = classes.length; i < len; i++) {\n      if ((value = cc(classes[i], prefix))) {\n        className += (className && prefix) + value\n      }\n    }\n  } else {\n    for (var i in classes) {\n      if (classes.hasOwnProperty(i) && (value = classes[i])) {\n        className +=\n          (className && prefix) +\n          i +\n          (typeof value === \"object\" ? cc(value, prefix + i) : \"\")\n      }\n    }\n  }\n\n  return className\n}\n","\nexport const SEQUENCER_LENGTH = 256\nexport const SEQUENCER_INTERVAL = 100\nexport const NOTE_NAMES = [\n    'C', 'C#', 'D', 'Eb',\n    'E', 'F', 'F#', 'G',\n    'Ab', 'A', 'Bb', 'B',\n    'C', 'C#', 'D', 'Eb',\n    'E', 'F', 'F#', 'G',\n    'Ab', 'A', 'Bb', 'B',\n    'C'\n]\nexport const KEYBOARD_KEYS = [\n    'z','s','x','d','c','v',\n    'g','b','h','n','j','m',\n    'q','2','w','3','e','r',\n    '5','t','6','y','7','u',\n    'i'\n]\n\nexport const KEYBOARD_BLACK_KEYS = [\n    's', 'd', 'g', 'h', 'j',\n    '2', '3', '5', '6', '7'\n]\n\nexport const SYNTH_DEFAULTS = {\n    octave: 4,\n    oscillatorType: 'triangle',\n    ampLevel: 0.3,\n    sustainLevel: 0.6,\n    attackTime: 0.02,\n    decayTime: 0.04,\n    releaseTime: 0.4,\n    filterCutoff: 7600,\n    filterQ: 10,\n}\n\n\nexport const OSCILLATOR_TYPES = ['sawtooth', 'square', 'triangle', 'sine']\n\nexport const TUNING_FREQ = 440;\nexport const TUNING_NOTE = 69;","import {h} from 'hyperapp'\nimport cc from 'classcat'\nimport css from './css/keyboard.css'\n\nimport {KEYBOARD_KEYS, KEYBOARD_BLACK_KEYS} from './const'\nconst isBlack  = char =>  KEYBOARD_BLACK_KEYS.indexOf(char) > -1\n\nconst Keyboard = ({pressed, attack, release}) => (\n    <div class={css.keyboard} key=\"keyboard\">\n        {KEYBOARD_KEYS.map(char => (\n        <div\n            class={cc([css.clav, {\n                [css.black]: isBlack(char),\n                [css.pressed]: char === pressed,\n            }])}\n            onmousedown={ ev => attack(char) }\n            onmouseup={ ev => release(char) }\n        >\n            <span class={css.char}>{char.toUpperCase()}</span>\n        </div>\n        ))}\n    </div>\n)\n\nexport default {\n    state: {\n        pressed: null\n    },\n\n    actions: {\n        \n        init: ({onpress}) => (state, actions) => {\n            addEventListener('keydown', ev => actions.attack(ev.key) && ev.preventDefault(true))\n            addEventListener('keyup', ev => actions.release(ev.key) && ev.preventDefault(true))\n            return {onpress}\n        },\n        \n        attack: char => state => {\n            const note = KEYBOARD_KEYS.indexOf(char)\n            if (note === -1) return\n            if (char === state.pressed) return\n            state.onpress(note)\n            return {pressed: char}\n        },\n\n        release: char => state => {\n            const note = KEYBOARD_KEYS.indexOf(char)\n            if (note === -1) return\n            if (char !== state.pressed) return\n            state.onpress(null)\n            return {pressed: null}\n        }\n    },\n\n    view: (state, actions) => ({\n        Keyboard: _ => Keyboard({\n            attack: actions.attack,\n            release: actions.release,\n            pressed: state.pressed,\n        })\n    })\n}\n","function stackHandlers (attr, name, handler) {\n    let orig = attr[name]\n    attr[name] = (!orig ? handler : (...args) => {\n        orig(...args)\n        fn(...args)\n    })\n}\n\nexport default getDeco => (attr, children) => {\n    const decorations = getDeco(attr)\n    return children.map(child => {\n        if (!child.attributes) return child\n        for (let name in decorations) {\n            if (name === 'class') {\n                child.attributes.class = child.attributes.class + ' ' + decorations.class\n            } else if (name.substr(0, 2) === 'on') {\n                stackHandlers(child.attributes, name, decorations[name])\n            } else {\n                child.attributes[name] = decorations[name]\n            }\n        }\n        return child\n    })\n}","import decorator from './lib/decorator'\nimport css from './css/sequencer.css'\n\nconst isSelected = (state, row, col) => {\n    if (state.start === null) return false\n    var r = (col === state.column && row >= state.start && row <= state.end)\n    return r\n}\n\nexport const applySelection = (state, notes, note) => {\n    if (state.start === null) return notes\n    return notes.map((rowvals, row) =>\n        rowvals.map((val, col) =>\n            isSelected(state, row, col) ? note : val\n        )\n    )\n}\n\nexport const module = _ => ({\n\n    state: {\n        anchor: null,\n        column: null,\n        start: null,\n        end: null,\n        selecting: false,\n        haveSelection: false,\n    },\n\n    actions: {\n        _set: x => x,\n\n        init: ({onselectcolumn}) => (state, actions) => {\n            actions._set({onselectcolumn})\n            actions.reset()\n        },\n\n        start: ({row, col}) => state => {\n            state.onselectcolumn(col)\n            return {\n                selecting: true,\n                haveSelection: true,\n                anchor: row,\n                column: col,\n                start: row,\n                end: row,\n            }\n        },\n\n        select: ({row}) => state => {\n            if (state.anchor === null) return\n            return (row < state.anchor )\n            ? {start: row, end:state.anchor}\n            : {start: state.anchor, end: row}\n        },\n\n        end: ({row}) => ({anchor: null, selecting: false}),\n\n        reset: _ => ({\n            anchor: null,\n            column: null,\n            start: null,\n            end: null,\n            selecting: false,\n            haveSelection: false\n        })\n    },\n\n    view: (state, actions) => ({\n        Decorator: decorator(({row, col, disabled}) => (!disabled ?  {\n            onmousedown: ev => {\n                ev.preventDefault(true)\n                actions.start({row, col})\n            },\n            onmouseup: ev => {\n                ev.preventDefault(true)\n                actions.end({row, col})\n            },\n            onmouseover: ev => {\n                ev.preventDefault(true)\n                actions.select({row, col})\n            },\n            class: isSelected(state, row, col) ? css.selected : ''\n        } : {}))\n    })\n})\n","import {h} from 'hyperapp'\nimport css from './css/button.css'\nimport cc from 'classcat'\nexport default (props, children) => {\n    let active = props.active\n    delete props.active\n    let cmd = props.do\n    delete props.do\n    return (\n        <button\n            {...props}\n            class={cc({[css.active]: active})}\n            onmousedown={cmd}\n        >\n            {children}\n        </button>\n    )\n}\n","import {h} from 'hyperapp'\nimport {SEQUENCER_INTERVAL, SEQUENCER_LENGTH} from './const'\nimport Button from './button'\n\nexport default _ => ({\n    state: {\n        playing: false,\n        interval: null,\n        row: null,\n    },\n\n    actions: {\n        init: ({onplayrow, onstop, onstart}) => ({onplayrow, onstop, onstart}),\n        setRow: row => ({row}),\n        next: _ => (state, actions) => {\n            var row = (state.row + 1) % SEQUENCER_LENGTH\n            state.onplayrow(row)\n            actions.setRow(row)\n        },\n        play: _ => (state, actions) => {\n            if (state.interval) return\n            state.onstart()\n            actions.setRow((state.row || 0) - 1)\n            return ({playing: true, interval: setInterval(actions.next, SEQUENCER_INTERVAL)})\n        },\n        stop: _ => (state, actions) => {\n            state.interval && clearInterval(state.interval)\n            state.onstop()\n            return ({playing: false, interval: null})\n        }\n    },\n\n    view: (state, actions) => ({\n        PlayButton: _ => (\n            <Button\n                do={actions.play}\n                active={state.interval}\n            >\n                Play\n            </Button>\n        ),\n        StopButton: _ => (<Button do={actions.stop}>Stop</Button>),\n    })\n})","import {h} from 'hyperapp'\nimport {NOTE_NAMES, SEQUENCER_INTERVAL, SEQUENCER_LENGTH} from './const'\nimport {module as selection, applySelection} from './selection'\nimport playback from './playback'\nimport Button from './button'\nimport css from './css/sequencer.css'\n\nconst noteName = note => {\n    return ((note === null) ? '' : NOTE_NAMES[note])\n}\n\n\n\nexport default {\n    modules: {\n        selection: selection(),\n        playback: playback(),\n    },\n\n    state: { notes: [...Array(SEQUENCER_LENGTH).keys()].map(_ => [...Array(8).keys()].map(_ => null)) },\n\n    actions: {\n\n        init: ({onselectvoice, onplay, onstop}) => (state, actions) => {\n\n            window.addEventListener('keydown', ev => {\n                if (ev.key !== ' ') return\n                ev.preventDefault(true)\n                actions.controlPress()\n            })\n\n            actions.selection.init({\n                onselectcolumn: col => onselectvoice('ABCDEFGH'[col])\n            })\n\n            actions.playback.init({\n                onstart: actions.selection.reset,\n                onplayrow: actions.playRow,\n                onstop: _ => {\n                    actions.stopRecording()\n                    onstop()\n                },\n            })\n            return {onplay}\n        },\n\n        controlPress: _ => (state, actions) => {\n            if (state.playback.playing) {\n                actions.playback.stop()\n            } else if (state.selection.haveSelection) {\n                actions.setNoteOnSelection(null)\n            } else {\n                actions.playback.play()\n            }\n        },\n\n        attack: ({note, voice}) => (state, actions) => {\n            if (state.selection.haveSelection) actions.setNoteOnSelection(note)\n            if (state.recording) actions.recordNote({note, voice})\n        },\n\n        release: _ => (state, actions) => {\n            if (state.recording) {\n                return {recordingNote: null}\n            }\n        },\n\n        setNoteOnSelection: note => (state, actions) => {\n            const notes = applySelection(state.selection, state.notes, note)\n            actions.selection.reset()\n            return { notes }\n        },\n\n        playRow: row => (state, actions) => {\n            if (state.recordingNote) actions.setRecordedNote(state.recordingNote)\n            state.notes[row].forEach((note, col) => {\n                const voice = 'ABCDEFGH'[col]\n                if (state.recordingNote && state.recordingNote.voice === voice) return\n                state.onplay({voice: 'ABCDEFGH'[col], note})\n            })\n        },\n        startRecording: _ => (state, actions) => {\n            actions.playback.play()\n            return {recording: true}\n        },\n\n        stopRecording: _ => ({recording: false, recordingNote: null}),\n\n        recordNote: ({note, voice}) => (state, actions) => {\n            actions.setRecordedNote({note, voice})\n            return {recordingNote: {note, voice}}\n        },\n\n        setRecordedNote: ({note, voice}) => (state) => {\n            const notes = state.notes.map((arr, row) => arr.map((oldNote, col) => {\n                if (row === state.playback.row && 'ABCDEFGH'[col] === voice) return note\n                return oldNote\n            }))\n            return {notes}\n        },\n\n\n    },\n\n    view: (state, actions, views) => ({\n        Controls: _ => (\n            <span>\n                <Button do={actions.startRecording} active={state.recording}>Rec</Button>\n                <views.playback.PlayButton />\n                <views.playback.StopButton />\n                <Button do={_ => actions.setNote(null)}>X</Button>\n            </span>\n        ),\n        Sequencer: _ => (\n            <div class={css.scrollContainer}>\n                <table class={css.sequencer}>\n                    {state.notes.map((vals, row) => (\n                        <tr onupdate={el => {\n                            if (state.playback.playing && state.playback.row === row-5) el.scrollIntoView(false)\n                        }}>\n                            <td  onclick={_ => actions.playback.setRow(row)} class={css.time + (state.playback.row === row ? css.playing : '')}>{row}</td>\n                            {vals.map((note, col) => (\n                                <views.selection.Decorator row={row} col={col} disabled={state.playback.playing}>\n                                    <td class={state.playback.row === row ? css.playing : false}>{noteName(note)}</td>\n                                </views.selection.Decorator>\n                            ))}\n                        </tr>\n                    ))}\n                </table>\n            </div>\n        )\n    })\n}\n","import {TUNING_NOTE, TUNING_FREQ, SYNTH_DEFAULTS} from './const'\n\nfunction noteToHz (note, octave) {\n    return Math.exp ((octave * 12 + note  - TUNING_NOTE) * Math.log(2) / 12) * TUNING_FREQ;\n}\nconst ctx = new (window.AudioContext || window.webkitAudioContext)()\n\nclass Instrument {\n    \n    constructor () {\n        this.oscillator = ctx.createOscillator()\n        this.filter = ctx.createBiquadFilter()\n        this.envelope = ctx.createGain()\n        this.amplifier = ctx.createGain()\n\n        this.oscillator.connect(this.filter)\n        this.filter.connect(this.envelope)\n        this.envelope.connect(this.amplifier)\n        this.amplifier.connect(ctx.destination)\n        this.set(SYNTH_DEFAULTS)\n        this.envelope.gain.value = 0;\n        this.oscillator.start()\n    }\n\n    set (props) {\n        if (props.oscillatorType) this.oscillator.type = props.oscillatorType\n        if (props.filterCutoff)   this.filter.frequency.value = props.filterCutoff\n        if (props.filterQ)        this.filter.Q.value = props.filterQ\n        if (props.ampLevel)       this.amplifier.gain.value = props.ampLevel\n        if (props.attackTime)     this.attackTime = props.attackTime\n        if (props.decayTime)      this.decayTime = props.decayTime\n        if (props.sustainLevel)   this.sustainLevel = props.sustainLevel\n        if (props.octave)         this.octave = props.octave\n        if (props.releaseTime)    this.releaseTime = props.releaseTime\n    }\n\n    attack (note) {\n        const freq = noteToHz(note, this.octave)\n        var t = ctx.currentTime\n        this.oscillator.frequency.cancelScheduledValues(t)\n        this.envelope.gain.cancelScheduledValues(t)\n        t += 0.01\n        this.oscillator.frequency.linearRampToValueAtTime(freq, t)\n        this.envelope.gain.linearRampToValueAtTime(0, t)\n        t += this.attackTime\n        this.envelope.gain.linearRampToValueAtTime(1, t)\n        t += this.decayTime\n        this.envelope.gain.linearRampToValueAtTime(this.sustainLevel, t)    \n    }\n\n    release () { \n        var t = ctx.currentTime + 0.01\n        this.envelope.gain.cancelScheduledValues(t)\n        t += this.releaseTime\n        this.envelope.gain.linearRampToValueAtTime(0, t)\n    }\n}\n\nexport default {\n    instruments: {\n        'A': new Instrument(),\n        'B': new Instrument(),\n        'C': new Instrument(),\n        'D': new Instrument(),\n        'E': new Instrument(),\n        'F': new Instrument(),\n        'G': new Instrument(),\n        'H': new Instrument(),\n    },\n    attack(i, note) { this.instruments[i].attack(note) },\n    release(i) { this.instruments[i].release() },\n    set(i, props) {this.instruments[i].set(props)},\n}\n\n","import {h} from 'hyperapp'\nimport cc from 'classcat'\nimport Button from './button'\n\nexport default props => props.options.map(opt => (\n    <Button\n        active={opt.value === props.value}\n        do={ev => props.set(opt.value)}\n    >\n        {opt.name}\n    </Button>\n))\n","import {h} from 'hyperapp'\nimport {SYNTH_DEFAULTS, OSCILLATOR_TYPES} from './const'\nimport voices from './voices'\nimport OptionButtonSet from './option-button-set'\nimport css from './css/synth.css'\n\nconst ctx = new (window.AudioContext || window.webkitAudioContext)()\n\nconst Control = (props, children) => (\n    <p>\n        <span class={css.label}>{props.label}:</span>\n        {children}\n    </p>\n)\n\nconst ControlSlider = props => (\n    <Control label={props.label}>\n        <input\n            type=\"range\"\n            min={props.min || 0}\n            max={props.max}\n            step={props.step || 'any'}\n            value={props.value}\n            oninput={ev => props.set(+ev.currentTarget.value)}\n        />\n    </Control>\n)\n\nconst ControlOptions = props => (\n    <Control label={props.label}>\n        <OptionButtonSet\n            options={props.options.map(o => ({name: o, value: o}))}\n            value={props.value}\n            set={props.set}\n        />\n    </Control>\n)\n\nexport default voice => ({\n    state: {\n        ...SYNTH_DEFAULTS,\n        current: null,\n    },\n\n    actions: {\n        set: x => state => {\n            voices.set(voice, x)\n            return x\n        },\n        play: note => (state, actions) => {\n            if (state.current === note) return\n            if (note === null) {\n                voices.release(voice)\n            } else {\n                voices.attack(voice, note)\n            }\n            return {current: note}\n        },\n        // release: _ => state => {\n        //     if (state.current === null) return \n        //     voices.release(voice)\n        //     return {current: null}\n        // },\n    },\n\n    view: (state, actions, views) => {\n        const controlProps = name => ({\n            value: state[name],\n            set: x => actions.set({[name]: x})\n        })\n        return {\n            ControlPanel: _ => (\n                <div class={css.synthPanel}>\n                    <div class={css.col1}>\n                        <ControlSlider  label=\"Octave\"     {...controlProps('octave')}         min={1} max={6} step={1} />\n                        <ControlOptions label=\"Oscillator\" {...controlProps('oscillatorType')} options={OSCILLATOR_TYPES} />\n                        <ControlSlider  label=\"Cutoff\"     {...controlProps('filterCutoff')}   min={60} max={7600} />\n                        <ControlSlider  label=\"Resonance\"  {...controlProps('filterQ')}        max={20} />\n                    </div>\n                    <div class={css.col2}>\n                        <ControlSlider label=\"Attack time\"   {...controlProps('attackTime')}   max={0.2} />\n                        <ControlSlider label=\"Decay time\"    {...controlProps('decayTime')}    max={0.2} />\n                        <ControlSlider label=\"Sustain level\" {...controlProps('sustainLevel')} max={1.0} />\n                        <ControlSlider label=\"Release time\"  {...controlProps('releaseTime')}  max={1.0} />\n                        <ControlSlider label=\"Gain\"          {...controlProps('ampLevel')}     max={1.0} />\n                    </div>\n                </div>\n            )\n        }\n    }\n})\n","import {h} from 'hyperapp'\nimport synth from './synth'\nimport OptionButtonSet from './option-button-set'\nimport css from './css/soundbank.css'\n\nexport default {\n    modules: {\n        A: synth('A'),\n        B: synth('B'),\n        C: synth('C'),\n        D: synth('D'),\n        E: synth('E'),\n        F: synth('F'),\n        G: synth('G'),\n        H: synth('H'),\n    },\n    state: {selected: 'A'},\n    actions: {\n        init: ({onselect}) => ({onselect}),\n        select: x => ({selected: x}),\n        play: ({voice, note}) => (_, actions) => {\n            actions[voice].play(note)\n        },\n        stopAll: _ => (_, actions) => 'ABCDEFGH'.split('').forEach(v => actions[v].play(null) ) \n    },\n    view: (state, actions, views) => ({\n        ControlPanel: views[state.selected].ControlPanel,\n        Selector: _ => (\n            <div class={css.voiceSelector}>\n                <OptionButtonSet\n                    options={'ABCDEFGH'.split('').map(n => ({name: `Voice ${n}`, value:n}))}\n                    set={x => {\n                        actions.select(x)\n                        state.onselect(x)\n                    }}\n                    value={state.selected}\n                />\n            </div>\n        ),\n    })\n}","import {h} from 'hyperapp'\nimport css from './css/main.css'\n\nimport keyboard from './keyboard'\nimport sequencer from './sequencer'\nimport soundbank from './soundbank'\n\n\nexport default {\n    modules: {\n        sequencer,\n        keyboard,\n        soundbank,\n    },\n\n    actions: {\n        init: _ => (_, actions) => {\n            actions.keyboard.init({onpress: actions.keyPress})\n            actions.sequencer.init({\n                onselectvoice: actions.soundbank.select,\n                onplay: actions.sequencerPlay,\n                onstop: actions.soundbank.stopAll,\n            })\n            actions.soundbank.init({\n                onselect: actions.sequencer.selection.reset\n            })\n        },\n\n        sequencerPlay: ({note, voice}) => (state, actions) => {\n            if (state.keyboard.pressed && voice === state.soundbank.selected) return\n            actions.soundbank.play({note, voice})\n        },\n\n        keyPress: (note) => (state, actions) => {\n            let voice = state.soundbank.selected\n            actions.soundbank.play({note, voice})\n            actions.sequencer.attack({note, voice})\n        }\n    },\n\n    view: (state, actions, views) => (\n        <div class={css.container}>\n            <div class={css.left}>\n                <div class={css.mainPanel}>\n                    <views.sequencer.Controls />\n                    <views.soundbank.Selector />\n                    <views.soundbank.ControlPanel />\n                </div>\n                <views.keyboard.Keyboard />\n            </div>\n            <div class=\"app-layout-right\">\n                <views.sequencer.Sequencer />\n            </div>\n        </div>\n    )\n}","import './css/base.css'\nimport {app} from 'hyperapp'\nimport combineModules from './lib/combine-modules'\nimport main from './main'\nconst {state, actions, view} = combineModules(main)\nconst {init} = app(state, actions, view, document.body)\ninit()\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}